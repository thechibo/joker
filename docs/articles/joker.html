<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An Introduction to joker • joker</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to joker">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">joker</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.13.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/joker.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thechibo/joker">GitHub</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thechibo/joker/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>An Introduction to joker</h1>
                        <h4 data-toc-skip class="author">Ioannis
Oikonomidis</h4>
            
            <h4 data-toc-skip class="date">2025-04-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thechibo/joker/blob/HEAD/vignettes/joker.Rmd" class="external-link"><code>vignettes/joker.Rmd</code></a></small>
      <div class="d-none name"><code>joker.Rmd</code></div>
    </div>

    
    
<p>The <code>joker</code> package provides a comprehensive set of
features for probabilities and mathematical statistics. It extends the
range of available distribution families and facilitates the computation
of key parametric quantities, such as moments and information-theoretic
measures. The main focus of the package is parameter estimation through
maximum likelihood and moment-based methods under an intuitive and
efficient framework.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Package <code>joker</code> is designed to cover a broad collection of
distribution families, extending the functionalities of the
<code>stats</code> package to support new families, parametric quantity
computation and parameter estimation. All package features are available
both in a <code>stats</code>-like syntax for entry-level users, and in
an <code>S4</code> object-oriented programming system for more
experienced ones. This section introduces the state-of-the-art
<code>R</code> packages in this direction, highlighting both the
advantages and the shortcomings of each package.</p>
</div>
<div class="section level2">
<h2 id="the-joker-s4-distribution-system">The joker <code>S4</code> Distribution System<a class="anchor" aria-label="anchor" href="#the-joker-s4-distribution-system"></a>
</h2>
<div class="section level3">
<h3 id="probability-distributions">Probability Distributions<a class="anchor" aria-label="anchor" href="#probability-distributions"></a>
</h3>
<p>In the <code>joker</code> OOP system each distribution has a
respective <code>S4</code> class, all of which are subclasses of the
<code>Distribution</code> <code>S4</code> class. Defining an object from
the desired distribution class is straightforward, as seen in the
following example. The parameter names, which are generally identical to
the ones defined in the <code>stats</code> package, can be omitted.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shape1</span> <span class="op">&lt;-</span> <span class="fl">1</span> </span>
<span><span class="va">shape2</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Beta.html">Beta</a></span><span class="op">(</span><span class="va">shape1</span>, <span class="va">shape2</span><span class="op">)</span></span></code></pre></div>
<p>Having defined the distribution object <code>D</code>, the
<code><a href="../reference/distributions.html">d()</a></code>-<code><a href="../reference/distributions.html">p()</a></code>-<code><a href="../reference/distributions.html">q()</a></code>-<code><a href="../reference/distributions.html">r()</a></code>
functions can be used, as shown in the following example, comparing
against the <code>stats</code> syntax.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">d</span>(D, <span class="fl">0.5</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">1</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">dbeta</span>(<span class="fl">0.5</span>, shape1, shape2)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">1</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">p</span>(D, <span class="fl">0.5</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.75</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">pbeta</span>(<span class="fl">0.5</span>, shape1, shape2)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.75</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">qn</span>(D, <span class="fl">0.75</span>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.5</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="fu">qbeta</span>(<span class="fl">0.75</span>, shape1, shape2)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.5</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="fu">r</span>(D, <span class="dv">2</span>)</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.2494058</span> <span class="fl">0.3353119</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="fu">rbeta</span>(<span class="dv">2</span>, shape1, shape2)</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.15414668</span> <span class="fl">0.06689389</span></span></code></pre></div>
<p>Alternatively, if only the distribution argument is supplied, the
methods behave as functionals (i.e. they return a function). This
behavior offers enhanced functionality such as:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>F1 <span class="ot">&lt;-</span> <span class="fu">p</span>(D)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">F1</span>(<span class="fl">0.5</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.75</span></span></code></pre></div>
<p><em>Technical Detail:</em> The quantile function is called
<code><a href="../reference/distributions.html">qn()</a></code> rather than the more intuitive <code><a href="../reference/distributions.html">q()</a></code>. The
reason behind this choice lies in the <code>RStudio</code> IDE
(Integrated Development Environment), which overrides the method
selection process of the <code>base</code> function <code><a href="../reference/distributions.html">q()</a></code>
used to quit an <code>R</code> session, i.e. a function named
<code><a href="../reference/distributions.html">q()</a></code> always ends the session. In order to avoid this
unpleasant behavior, the name <code><a href="../reference/distributions.html">qn()</a></code> was chosen instead.</p>
</div>
<div class="section level3">
<h3 id="parametric-quantities-of-interest">Parametric Quantities of Interest<a class="anchor" aria-label="anchor" href="#parametric-quantities-of-interest"></a>
</h3>
<p>The <code>joker</code> package contains a set of methods that
calculate the theoretical moments (expectation, variance and standard
deviation, skewness, excess kurtosis) and other important parametric
functions (median, mode, entropy, Fisher information) of a distribution.
Alternatively, the <code><a href="../reference/moments.html">moments()</a></code> function automatically finds
the available methods for a given distribution and returns all of the
results in a list.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">mean</span>(D)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.3333333</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">median</span>(D)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.2928932</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">mode</span>(D)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">0</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">var</span>(D)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.05555556</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">sd</span>(D)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.2357023</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">skew</span>(D)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.5656854</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="fu">kurt</span>(D)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.2333333</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="fu">entro</span>(D)</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="sc">-</span><span class="fl">0.1931472</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="fu">finf</span>(D)</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="sc">&gt;</span>            shape1     shape2</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="sc">&gt;</span> shape1  <span class="fl">1.2500000</span> <span class="sc">-</span><span class="fl">0.3949341</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="sc">&gt;</span> shape2 <span class="sc">-</span><span class="fl">0.3949341</span>  <span class="fl">0.2500000</span></span></code></pre></div>
<p><em>Technical Detail:</em> Only the function-distribution
combinations that are theoretically defined are available; for example,
while <code><a href="../reference/moments.html">var()</a></code> is available for all distributions,
<code><a href="../reference/moments.html">sd()</a></code> is available only for the univariate ones. In case the
result is not unique, a predetermined value is returned with a warning.
The following example illustrates this in the case of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℬ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{B}(1, 1)</annotation></semantics></math>,
i.e. a uniform distribution for which every value in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math>
interval is a mode.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">mode</span>(<span class="fu">Beta</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="sc">&gt;</span> Warning <span class="cf">in</span> <span class="fu">mode</span>(<span class="fu">Beta</span>(<span class="dv">1</span>, <span class="dv">1</span>))<span class="sc">:</span> In <span class="fu">Beta</span>(<span class="dv">1</span>, <span class="dv">1</span>), all elements <span class="cf">in</span> the [<span class="dv">0</span>, <span class="dv">1</span>] interval are modes. <span class="fl">0.5</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="sc">&gt;</span>             is returned by default.</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.5</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="parameter-estimation">Parameter Estimation<a class="anchor" aria-label="anchor" href="#parameter-estimation"></a>
</h2>
<p>The <code>joker</code> package includes a number of options when it
comes to parameter estimation. In order to illustrate these
alternatives, a random sample is generated from the Beta
distribution.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">shape1</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">shape2</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Beta.html">Beta</a></span><span class="op">(</span><span class="va">shape1</span>, <span class="va">shape2</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distributions.html">r</a></span><span class="op">(</span><span class="va">D</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="estimation-methods">Estimation Methods<a class="anchor" aria-label="anchor" href="#estimation-methods"></a>
</h3>
<p>The package covers three major estimation methods: maximum likelihood
estimation (MLE), moment estimation (ME), and score-adjusted estimation
(SAME).</p>
<p>In order to perform parameter estimation, a new
<code>e&lt;name&gt;()</code> member is added to the
<code><a href="../reference/distributions.html">d()</a></code>-<code><a href="../reference/distributions.html">p()</a></code>-<code><a href="../reference/distributions.html">q()</a></code>-<code><a href="../reference/distributions.html">r()</a></code>
family, following the standard <code>stats</code> name convention. These
<code>e&lt;name&gt;()</code> functions take two arguments, the
observations <code>x</code> (an atomic vector for univariate or a matrix
for multivariate distibutions) and the <code>type</code> of estimation
method to use (a character with possible values <code>"mle"</code>,
<code>"me"</code>, and <code>"same"</code>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ebeta</span>(x, <span class="at">type =</span> <span class="st">"mle"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>shape1</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.066968</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>shape2</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.466715</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">ebeta</span>(x, <span class="at">type =</span> <span class="st">"me"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>shape1</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.074511</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>shape2</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.469756</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="fu">ebeta</span>(x, <span class="at">type =</span> <span class="st">"same"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>shape1</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.067768</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>shape2</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.454257</span></span></code></pre></div>
<p>Point estimation functions are available in two versions, the
distribution specific one, e.g. <code><a href="../reference/Beta.html">ebeta()</a></code>, and the
<code>S4</code> generic ones, namely <code><a href="../reference/estimation.html">mle()</a></code>,
<code><a href="../reference/estimation.html">me()</a></code>, and <code><a href="../reference/estimation.html">same()</a></code>. A general function called
<code><a href="../reference/estimation.html">e()</a></code> is also implemented, covering all distributions and
estimators.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">mle</span>(D, x)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>shape1</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.066968</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>shape2</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.466715</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="fu">me</span>(D, x)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>shape1</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.074511</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>shape2</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.469756</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">same</span>(D, x)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>shape1</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.067768</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>shape2</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.454257</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="fu">e</span>(D, x, <span class="at">type =</span> <span class="st">"mle"</span>)</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>shape1</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.066968</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>shape2</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.466715</span></span></code></pre></div>
<p><em>Technical Detail:</em> It is important to note that the
<code>S4</code> methods also accept a character for the distribution.
The name should be the same as the <code>S4</code> distribution
generator, case ignored.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimation.html">mle</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/estimation.html">mle</a></span><span class="op">(</span><span class="st">"bEtA"</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/estimation.html">e</a></span><span class="op">(</span><span class="st">"Beta"</span>, <span class="va">x</span>, type <span class="op">=</span> <span class="st">"mle"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="log-likelihood">Log-likelihood<a class="anchor" aria-label="anchor" href="#log-likelihood"></a>
</h3>
<p>Log-likelihood functions are also available in two versions, the
distribution specific one, e.g. <code><a href="../reference/Beta.html">llbeta()</a></code>, and the
<code><a href="../reference/loglikelihood.html">ll()</a></code> <code>S4</code> generic one.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">llbeta</span>(x, shape1, shape2)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">26.56269</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">ll</span>(D, x)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">26.56269</span></span></code></pre></div>
<p>In some distribution families like beta and gamma, the MLE cannot be
explicitly derived and numerical optimization algorithms have to be
employed. Even in <em>good</em> scenarios, with plenty of observations
and a smooth optimization function, numerical algorithms should not be
viewed as panacea, and extra care should be taken to ensure a fast and
right convergence if possible. Two important steps are taken in
<code>joker</code> in this direction:</p>
<p>An illustrative example for the Beta distribution is shown below. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
denote the probability density function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∼</mo><mi>ℬ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X\sim\mathcal{B}(\alpha,\beta)</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>;</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>x</mi><mrow><mi>α</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mspace width="1.0em"></mspace><mn>0</mn><mo>&lt;</mo><mi>x</mi><mo>&lt;</mo><mn>1</mn><mo>,</mo></mrow><annotation encoding="application/x-tex">
f(x; \alpha, \beta) = \frac{\Gamma(\alpha + \beta)}{\Gamma(\alpha) \Gamma(\beta)}x^{\alpha-1} (1 - x)^{\beta-1}, \quad 0 &lt; x &lt; 1,
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
is the Gamma function. Then, the log-likelihood function, divided by the
sample size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>,
takes the form:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mover><mrow><mo>log</mo><mi>X</mi></mrow><mo accent="true">¯</mo></mover><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mover><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">¯</mo></mover><mo>−</mo><mo>log</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\ell(\alpha, \beta) = (\alpha - 1) \overline{\log X} + (\beta - 1) \overline{\log (1 - X)} - \log \Gamma(\alpha) - \log \Gamma(\beta) + \log \Gamma(\alpha + \beta).
</annotation></semantics></math></p>
<p>The score equation for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><mo>ℓ</mo></mrow><mrow><mi>∂</mi><mi>α</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mover><mrow><mo>log</mo><mi>X</mi></mrow><mo accent="true">¯</mo></mover><mo>−</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
\frac{\partial \ell}{\partial \alpha}(\alpha, \beta) = \overline{\log X} - \psi(\alpha) + \psi(\alpha + \beta) = 0.
</annotation></semantics></math></p>
<p>The score equation for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><mo>ℓ</mo></mrow><mrow><mi>∂</mi><mi>β</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mover><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">¯</mo></mover><mo>−</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
\frac{\partial \ell}{\partial \beta}(\alpha, \beta) = \overline{\log (1 - X)} - \psi(\beta) + \psi(\alpha + \beta) = 0.
</annotation></semantics></math></p>
<p>These two nonlinear equations must be solved numerically. However,
instead of solving the above two-dimensional problem, one can see that
by denoting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>:=</mo><mi>α</mi><mo>+</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">c := \alpha + \beta</annotation></semantics></math>,
the two score equations can be rewritten as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><msup><mi>ψ</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mover><mrow><mo>log</mo><mi>X</mi></mrow><mo accent="true">¯</mo></mover><mo stretchy="true" form="postfix">]</mo></mrow><mspace width="1.0em"></mspace><mi>β</mi><mo>=</mo><msup><mi>ψ</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">[</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mover><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">¯</mo></mover><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
  \alpha = \psi^{-1}\left[\psi(c) + \overline{\log X}\right] \quad \beta = \psi^{-1}\left[\psi(c) + \overline{\log (1-X)}\right],
</annotation></semantics></math></p>
<p>i.e. restricted to the score equation system solution space, both
parameters can be expressed as a function of their sum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>,
and therefore the log-likelihood function can be optimized with respect
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mo>ℓ</mo><mo>⋆</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>α</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mover><mrow><mo>log</mo><mi>X</mi></mrow><mo accent="true">¯</mo></mover><mo>+</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mover><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mo accent="true">¯</mo></mover><mo>−</mo><mo>log</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>α</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>−</mo><mo>log</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mo>log</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\ell^\star(c) = \left[\alpha(c) - 1\right] \overline{\log X} + \left[\beta(c) - 1\right] \overline{\log (1 - X)} - \log \Gamma\left[\alpha(c)\right] - \log \Gamma\left[\beta(c)\right] + \log \Gamma(c).
</annotation></semantics></math></p>
<p><em>Technical Detail:</em> It would perhaps be more intuitive to use
the score equations to express
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
as a function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
or vice versa. However, the above method can be directly generalized to
the Dirichlet case and reduce the initial
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-dimensional
problem to a unidimensional one. The same technique can be utilized for
the gamma and multivariate gamma distribution families, also reducing
the dimension to unity, from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math>
respectively.</p>
<p>In <code>joker</code>, the resulting function that is inserted in the
optimization algorithm is called <code>lloptim()</code>, and is not to
be confused with the actual log-likelihood function <code><a href="../reference/loglikelihood.html">ll()</a></code>.
The corresponding derivative is called <code>dlloptim()</code>.
Therefore, whenever numerical computation of the MLE is required,
<code>joker</code> calls the <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> function with the
following arguments:</p>
<ul>
<li>
<code>lloptim()</code>, an efficient function to be optimized,</li>
<li>
<code>dlloptim()</code>, its analytically-computed derivate,</li>
<li>the ME or SAME as the starting point (user’s choice),</li>
<li>the L-BFGS-U optimization algorithm, with lower and upper limits
defined by default as the parameter space boundary.</li>
</ul>
</div>
<div class="section level3">
<h3 id="asymptotic-variance---covariance-matrix">Asymptotic Variance - Covariance Matrix<a class="anchor" aria-label="anchor" href="#asymptotic-variance---covariance-matrix"></a>
</h3>
<p>The asymptotic variance (or variance - covariance matrix for
multidimensional parameters) of the estimators are also covered in the
package by the <code>v&lt;name&gt;()</code> functions.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">vbeta</span>(shape1, shape2, <span class="at">type =</span> <span class="st">"mle"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="sc">&gt;</span>          shape1   shape2</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="sc">&gt;</span> shape1 <span class="fl">1.597168</span> <span class="fl">2.523104</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="sc">&gt;</span> shape2 <span class="fl">2.523104</span> <span class="fl">7.985838</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">vbeta</span>(shape1, shape2, <span class="at">type =</span> <span class="st">"me"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="sc">&gt;</span>        shape1 shape2</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="sc">&gt;</span> shape1    <span class="fl">2.1</span>    <span class="fl">3.3</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="sc">&gt;</span> shape2    <span class="fl">3.3</span>    <span class="fl">9.3</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="fu">vbeta</span>(shape1, shape2, <span class="at">type =</span> <span class="st">"same"</span>)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="sc">&gt;</span>          shape1   shape2</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="sc">&gt;</span> shape1 <span class="fl">1.644934</span> <span class="fl">2.539868</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="sc">&gt;</span> shape2 <span class="fl">2.539868</span> <span class="fl">8.079736</span></span></code></pre></div>
<p>As with point estimation, the implementation is twofold, and the
general function <code><a href="../reference/variance.html">v()</a></code> covers all distributions and
estimators.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">avar</span><span class="op">(</span><span class="va">D</span>, type <span class="op">=</span> <span class="st">"mle"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/variance.html">avar_mle</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/variance.html">avar_me</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/variance.html">avar_same</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="estimation-metrics-and-comparison">Estimation Metrics and Comparison<a class="anchor" aria-label="anchor" href="#estimation-metrics-and-comparison"></a>
</h2>
<p>The different estimators of a parameter can be compared based on both
finite sample and asymptotic properties. The package includes two
functions named <code><a href="../reference/SmallMetrics.html">small_metrics()</a></code> and
<code><a href="../reference/LargeMetrics.html">large_metrics()</a></code> , where small and large refers to the
<em>small sample</em> and <em>large sample</em> terms that are often
used for the two cases. The former estimates the bias, variance and root
mean square error (RMSE) of the estimator with Monte Carlo simulations,
while the latter calculates the asymptotic variance - covariance matrix
(as derived by the functions). The resulting data frames can be plotted
with the <code><a href="../reference/plot.html">plot()</a></code> function.</p>
<p>To illustrate the function’s design, consider the following example
from the beta distribution: We are interested to calculate the metrics
(bias, variance, and RMSE) of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
parameter estimators (MLE, ME, and SAME), for sample sizes 20 and 50.
Specifically, we want to illustrate how these metrics change for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>,</mo><mn>5</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha\in[1,5]</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\beta=2</annotation></semantics></math>
(constant). The following code can do that:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">Beta</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>prm <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">"shape1"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>            <span class="at">val =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.5</span>))</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">small_metrics</span>(D, prm,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>             <span class="at">obs =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">50</span>),</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>             <span class="at">est =</span> <span class="fu">c</span>(<span class="st">"mle"</span>, <span class="st">"same"</span>, <span class="st">"me"</span>),</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>             <span class="at">sam =</span> <span class="fl">1e2</span>,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>             <span class="at">seed =</span> <span class="dv">1</span>)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="fu">head</span>(x<span class="sc">@</span>df)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="sc">&gt;</span>   Parameter Observations Estimator Metric     Value</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span>       <span class="fl">1.0</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.1390594</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">2</span>       <span class="fl">1.5</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.1684557</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">3</span>       <span class="fl">2.0</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.2419830</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">4</span>       <span class="fl">2.5</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.3105948</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">5</span>       <span class="fl">3.0</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.2654124</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">6</span>       <span class="fl">3.5</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.4010657</span></span></code></pre></div>
<p>The <code><a href="../reference/SmallMetrics.html">small_metrics()</a></code> function takes the following
arguments:</p>
<ul>
<li>
<code>D</code>, the distribution object of interest,</li>
<li>
<code>prm</code>, a list that specifies how the <code>shape1</code>
parameter values should change,</li>
<li>
<code>obs</code>, a numeric vector holding the sample sizes,</li>
<li>
<code>est</code>, a character vector specifying the estimators under
comparison,</li>
<li>
<code>sam</code>, the Monte Carlo sample size to use for the metrics
estimation,</li>
<li>
<code>seed</code>, a seed to be passed to <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>
for replicability.</li>
</ul>
<p>The resulting data frame can be passed to <code><a href="../reference/plot.html">plot()</a></code> to see
the results. This <code><a href="../reference/plot.html">plot()</a></code> method depends on
<code>ggplot2</code> to provide a highly-customizable graph.</p>
<div class="figure">
<img src="joker_files/figure-html/unnamed-chunk-14-1.png" alt="Small-sample metrics comparison for MLE, ME, and SAME of the beta distribution $lpha$ parameter." width="100%"><p class="caption">
Small-sample metrics comparison for MLE, ME, and SAME of the beta
distribution <span class="math inline">$lpha$</span> parameter.
</p>
</div>
<p>Note that in some distribution families the parameter is a vector, as
is the case with the Dirichlet distribution (a multivariate
generalization of beta), which holds a single parameter vector
<code>alpha</code>. In these cases, the <code>prm</code> list can
include a third element, <code>pos</code>, specifying which parameter of
the vector should change:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">Dir</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>prm <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">"alpha"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>            <span class="at">pos =</span> <span class="dv">1</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>            <span class="at">val =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.5</span>))</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">small_metrics</span>(D, prm,</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>                   <span class="at">obs =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">50</span>),</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>                   <span class="at">est =</span> <span class="fu">c</span>(<span class="st">"mle"</span>, <span class="st">"same"</span>, <span class="st">"me"</span>),</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>                   <span class="at">sam =</span> <span class="fl">1e2</span>,</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>                   <span class="at">seed =</span> <span class="dv">1</span>)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="fu">class</span>(x)</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="st">"SmallMetrics"</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">attr</span>(,<span class="st">"package"</span>)</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="st">"joker"</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="fu">head</span>(x<span class="sc">@</span>df)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="sc">&gt;</span>   Parameter Observations Estimator Metric      Value</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span>       <span class="fl">1.0</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.04439027</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">2</span>       <span class="fl">1.5</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.10076876</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">3</span>       <span class="fl">2.0</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.13926634</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">4</span>       <span class="fl">2.5</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.20017190</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">5</span>       <span class="fl">3.0</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.34101551</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">6</span>       <span class="fl">3.5</span>           <span class="dv">20</span>       mle   Bias <span class="fl">0.26037083</span></span></code></pre></div>
<p>The <code><a href="../reference/LargeMetrics.html">large_metrics()</a></code> function design is almost identical,
except that no <code>obs</code>, <code>sam</code>, and <code>seed</code>
arguments are needed here. The following example illustrates the large
sample metrics for the beta distribution shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
estimators. Again, the resulting data frame can be passed to
<code><a href="../reference/plot.html">plot()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">Beta</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>prm <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">"shape1"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>            <span class="at">val =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">large_metrics</span>(D, prm,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                   <span class="at">est =</span> <span class="fu">c</span>(<span class="st">"mle"</span>, <span class="st">"same"</span>, <span class="st">"me"</span>))</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="fu">class</span>(x)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="st">"LargeMetrics"</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">attr</span>(,<span class="st">"package"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="st">"joker"</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="fu">head</span>(x<span class="sc">@</span>df)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="sc">&gt;</span>      Row    Col Parameter Estimator    Value</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span> shape1 shape1       <span class="fl">1.0</span>       mle <span class="fl">1.597168</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">2</span> shape2 shape1       <span class="fl">1.0</span>       mle <span class="fl">2.523104</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">3</span> shape1 shape2       <span class="fl">1.0</span>       mle <span class="fl">2.523104</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">4</span> shape2 shape2       <span class="fl">1.0</span>       mle <span class="fl">7.985838</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">5</span> shape1 shape1       <span class="fl">1.1</span>       mle <span class="fl">1.969699</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">6</span> shape2 shape1       <span class="fl">1.1</span>       mle <span class="fl">2.826906</span></span></code></pre></div>
<div class="figure">
<img src="joker_files/figure-html/unnamed-chunk-17-1.png" alt="Large-sample metrics comparison for MLE, ME, and SAME of the beta distribution $lpha$ parameter." width="1344"><p class="caption">
Large-sample metrics comparison for MLE, ME, and SAME of the beta
distribution <span class="math inline">$lpha$</span> parameter.
</p>
</div>
</div>
<div class="section level2">
<h2 id="documentation-and-testing">Documentation and Testing<a class="anchor" aria-label="anchor" href="#documentation-and-testing"></a>
</h2>
<div class="section level3">
<h3 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h3>
</div>
<div class="section level3">
<h3 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a>
</h3>
<p>The R package is rigorously tested to ensure reliability,
correctness, and stability. More than 1,000 automated tests have been
implemented using the <code>testthat</code> package, a widely used
framework for unit testing in R. These tests cover a broad range of
functionalities, including edge cases, error handling, and performance
checks, to verify that every function behaves as expected under various
conditions. Continuous testing helps detect potential regressions early,
maintaining the integrity of the package as it evolves. By leveraging
<code>testthat</code>, we ensure that all updates and modifications
uphold the expected behavior and performance standards.</p>
</div>
</div>
<div class="section level2">
<h2 id="defining-new-classes-and-methods">Defining New Classes and Methods<a class="anchor" aria-label="anchor" href="#defining-new-classes-and-methods"></a>
</h2>
<p>Of course, it is possible to be interested in a distribution family
not included in the package. It is straightforward for users to define
their own <code>S4</code> class and methods. Since this paper is
addressed to both novice and experienced <code>R</code> users, the beta
distribution paradigm is explained in detail below:</p>
<div class="section level3">
<h3 id="defining-the-class">Defining the Class<a class="anchor" aria-label="anchor" href="#defining-the-class"></a>
</h3>
<p>The <code>setClass()</code> function defines a new <code>S4</code>
class, i.e. the distribution of interest. The <code>slots</code>
argument defines the parameters and their respective class (usually
numeric, but it can also be a matrix in distributions like the
multivariate normal and the Wishart). The optional argument
<code>prototype</code> can be used to define the default parameter
values in case they are not specified by the user.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">setClass</span><span class="op">(</span><span class="st">"Beta"</span>,</span>
<span>  contains <span class="op">=</span> <span class="st">"Distribution"</span>,</span>
<span>  slots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="st">"numeric"</span>, shape2 <span class="op">=</span> <span class="st">"numeric"</span><span class="op">)</span>,</span>
<span>  prototype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="fl">1</span>, shape2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="defining-a-generator">Defining a Generator<a class="anchor" aria-label="anchor" href="#defining-a-generator"></a>
</h3>
<p>Now that the class is defined, one can type
<code>D &lt;- new("Beta", shape1 = shape1, shape2 = shape2)</code> to
create a new object of class <code>Beta</code>. However, this is not so
intuitive, and a wrapper function with the class name can be used
instead. This function, often called a <em>generator</em>, can be used
to simply code <code>D &lt;- Beta(1, 2)</code> and define a new object
from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ℬ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{B}(1,2)</annotation></semantics></math>
distribution. The parameter slots can be accessed with the
<code>@</code> sign, as shown above.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Beta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">shape1</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">shape2</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">new</span><span class="op">(</span><span class="st">"Beta"</span>, shape1 <span class="op">=</span> <span class="va">shape1</span>, shape2 <span class="op">=</span> <span class="va">shape2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Beta.html">Beta</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">D</span><span class="op">@</span><span class="va">shape1</span></span>
<span><span class="va">D</span><span class="op">@</span><span class="va">shape2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="defining-validity-checks">Defining Validity Checks<a class="anchor" aria-label="anchor" href="#defining-validity-checks"></a>
</h3>
<p>This step is optional but rather essential. So far, a user could type
<code>D &lt;- Beta(-1, 2)</code> without any errors, even though the
beta parameters are defined in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ℝ</mi><mo>+</mo></msub><annotation encoding="application/x-tex">\mathbb{R}_{+}</annotation></semantics></math>.
To prevent such behaviors (that will probably end in bugs further down
the road), the developer is advised to create a
<code>setValidity()</code> function, including all the necessary
restrictions posed by the parameter space.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">setValidity</span><span class="op">(</span><span class="st">"Beta"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">object</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">shape1</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"shape1 has to be a numeric of length 1"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">shape1</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"shape1 has to be positive"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">shape2</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"shape2 has to be a numeric of length 1"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">object</span><span class="op">@</span><span class="va">shape2</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"shape2 has to be positive"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="cn">TRUE</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="defining-the-class-methods">Defining the Class Methods<a class="anchor" aria-label="anchor" href="#defining-the-class-methods"></a>
</h3>
<p>Now that everything is set, it is time to define methods for the new
class. Creating functions and <code>S4</code> methods in <code>R</code>
are two very similar processes, except the latter wraps the function in
<code>setMethod()</code> and specifies a signature class, as shown
above. The package source code can be used to easily define all methods
of interest for the new distribution class.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># probability density function</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"d"</span>, signature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>distr <span class="op">=</span> <span class="st">"Beta"</span>, x <span class="op">=</span> <span class="st">"numeric"</span><span class="op">)</span>,</span>
<span>          <span class="kw">function</span><span class="op">(</span><span class="va">distr</span>, <span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="va">x</span>, shape1 <span class="op">=</span> <span class="va">distr</span><span class="op">@</span><span class="va">shape1</span>, shape2 <span class="op">=</span> <span class="va">distr</span><span class="op">@</span><span class="va">shape2</span><span class="op">)</span></span>
<span>          <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (theoretical) expectation</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"mean"</span>,</span>
<span>          signature  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Beta"</span><span class="op">)</span>,</span>
<span>          definition <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">x</span><span class="op">@</span><span class="va">shape1</span> <span class="op">/</span> <span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">shape1</span> <span class="op">+</span> <span class="va">x</span><span class="op">@</span><span class="va">shape2</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># moment estimator</span></span>
<span><span class="kw">setMethod</span><span class="op">(</span><span class="st">"me"</span>,</span>
<span>          signature  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>distr <span class="op">=</span> <span class="st">"Beta"</span>, x <span class="op">=</span> <span class="st">"numeric"</span><span class="op">)</span>,</span>
<span>          definition <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">distr</span>, <span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">m</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moments.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/moments.html">mean</a></span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">d</span>  <span class="op">&lt;-</span> <span class="op">(</span><span class="va">m</span> <span class="op">-</span> <span class="va">m2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">m2</span> <span class="op">-</span> <span class="va">m</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape1 <span class="op">=</span> <span class="va">d</span> <span class="op">*</span> <span class="va">m</span>, shape2 <span class="op">=</span> <span class="va">d</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ioannis Oikonomidis, Samis Trevezas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
